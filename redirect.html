<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord OAuth2 Redirect</title>
</head>
<body>
    <h1>Processing Your Request...</h1>
    <p>If you are not redirected, please wait a moment.</p>

    <script>
        // Fetch the code from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const code = urlParams.get('code');
        
        if (code) {
            // Prepare to exchange the code for an access token
            const client_id = '1303610727122075689'; // Your client ID
            const client_secret = 'Vr4aEa6aE27JMMlsFQ1Ma8bInVDStsCP'; // Your client secret
            const redirect_uri = 'https://insane-boat.info/redirect.html'; // Your redirect URI

            // Prepare the request data
            const requestData = new URLSearchParams({
                client_id: client_id,
                client_secret: client_secret,
                code: code,
                grant_type: 'authorization_code',
                redirect_uri: redirect_uri,
                scope: 'email' // Make sure email scope is requested
            });

            // Exchange the code for the access token// Exchange the code for the access token
fetch('https://discord.com/api/users/@me', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer ' + accessToken // Access token from the token exchange
    }
})
.then(response => response.json())
.then(userData => {
    console.log(userData);  // Here, userData is the entire response object
    if (userData.email) {
        console.log('Email:', userData.email);  // Access the email if available
    } else {
        console.log('No email found.');
    }
})
.catch(error => {
    console.error('Error:', error);
});

        } else {
            // If the code isn't available, display an error
            alert('Error: Authorization code not found.');
        }
    </script>
</body>
</html>
